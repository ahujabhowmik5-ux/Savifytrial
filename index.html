<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savify â€” The Waitlist</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.8.0/vanilla-tilt.min.js"></script>

    <style>
        :root {
            --bg-deep: #050505;
            --primary: #10B981; 
            --primary-glow: rgba(16, 185, 129, 0.4);
            --gold: #FFD700;
            --text-main: #FFFFFF;
            --text-muted: #9ca3af;
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-bg: rgba(20, 20, 20, 0.6);
            --mouse-x: 50%;
            --mouse-y: 50%;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-main);
            height: 100vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            cursor: none;
            transition: filter 1.5s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* --- BACKGROUND LAYERS --- */
        #canvas-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; pointer-events: none;
        }

        .bg-noise {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIj48ZmlsdGVyIGlkPSJhIj48ZmVUdXJYdWxlbmNlIGJhc2VGcmVxdWVuY3k9IjAuNjUiIG51bU9jdGF2ZXM9IjMiIHJlc3VsdD0ibm9pc2UiIHN0eWxlPSJjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM6c1JHQiIvPjxmZUNvbG9yTWF0cml4IGluPSJub2lzZSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMDUgMCIvPjwvZmlsdGVyPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbHRlcj0idXJsKCNhKSIvPjwvc3ZnPg==');
            opacity: 0.4; z-index: 2; pointer-events: none;
        }

        .grid-overlay {
            position: fixed; top: 0; left: 0; width: 200%; height: 200%;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-100px);
            animation: gridMove 20s linear infinite;
            z-index: 0; pointer-events: none;
            mask-image: linear-gradient(to bottom, transparent, black 40%, black 80%, transparent);
        }

        @keyframes gridMove {
            0% { transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-100px); }
            100% { transform: perspective(500px) rotateX(60deg) translateY(50px) translateZ(-100px); }
        }

        .mouse-spotlight {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 3;
            background: radial-gradient(800px circle at var(--mouse-x) var(--mouse-y), rgba(16, 185, 129, 0.15), rgba(255, 215, 0, 0.05) 30%, transparent 60%);
            pointer-events: none;
        }

        /* --- CUSTOM CURSOR --- */
        .cursor-dot, .cursor-circle {
            position: fixed; top: 0; left: 0;
            transform: translate(-50%, -50%); border-radius: 50%; z-index: 9999; pointer-events: none;
        }
        .cursor-dot { width: 8px; height: 8px; background: var(--primary); }
        .cursor-circle { width: 40px; height: 40px; border: 1px solid var(--primary); transition: width 0.2s, height 0.2s, background-color 0.2s; }
        body.hovering .cursor-circle { width: 60px; height: 60px; background-color: rgba(16, 185, 129, 0.1); border-color: var(--gold); }

        /* --- GLASS CARD --- */
        .glass-card {
            position: relative; z-index: 10;
            background: var(--glass-bg); border: 1px solid var(--glass-border);
            box-shadow: 0 40px 80px -20px rgba(0,0,0,0.8), inset 0 0 0 1px rgba(255,255,255,0.05);
            backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
            padding: 3.5rem 3rem; border-radius: 24px;
            width: 100%; max-width: 460px;
            transform-style: preserve-3d; transition: transform 0.1s;
        }

        .brand-header { text-align: center; margin-bottom: 2.5rem; transform: translateZ(40px); }
        .logo-icon { font-size: 2.5rem; color: var(--primary); margin-bottom: 0.5rem; filter: drop-shadow(0 0 15px var(--primary-glow)); }
        
        h1.brand-name {
            font-family: 'Playfair Display', serif; font-size: 3.5rem; font-weight: 700; margin: 0;
            background-image: linear-gradient(110deg, #bdc3c7 0%, #2c3e50 20%, var(--primary) calc(var(--mouse-x) * 1), var(--gold) calc(var(--mouse-x) * 1 + 10%), #bdc3c7 80%, #2c3e50 100%);
            background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .subtitle { color: var(--text-muted); font-size: 0.95rem; letter-spacing: 2px; text-transform: uppercase; font-weight: 500; margin-top: 0.5rem; }

        /* --- INPUTS --- */
        .input-group { position: relative; margin-bottom: 1.5rem; transform: translateZ(20px); }
        
        .input-field {
            width: 100%; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border);
            border-radius: 12px; padding: 1rem 1rem 0.5rem 1rem; height: 60px;
            font-size: 1rem; color: var(--text-main); outline: none;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .input-label {
            position: absolute; left: 1rem; top: 50%; transform: translateY(-50%);
            color: var(--text-muted); font-size: 1rem; pointer-events: none;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .input-field:focus, .input-field:not(:placeholder-shown) {
            border-color: var(--primary); background: rgba(16, 185, 129, 0.05);
            padding-top: 1.6rem; padding-bottom: 0.4rem; box-shadow: 0 0 20px rgba(16, 185, 129, 0.1);
        }

        .input-field:focus ~ .input-label, .input-field:not(:placeholder-shown) ~ .input-label {
            top: 0.8rem; font-size: 0.75rem; color: var(--primary); font-weight: 600; letter-spacing: 0.5px;
        }

        /* --- BUTTON --- */
        .submit-btn {
            width: 100%; height: 60px; margin-top: 1rem;
            border: none; border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), #059669);
            color: white; font-size: 1.1rem; font-weight: 600;
            cursor: none; position: relative; overflow: hidden;
            transform: translateZ(30px); transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.2);
        }

        .submit-btn::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: 0.5s;
        }
        .submit-btn:hover::before { left: 100%; }
        .submit-btn:hover { transform: translateZ(35px) scale(1.02); box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4); }

        .btn-content { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; height: 100%; }

        /* --- STATUS & EFFECTS --- */
        .status-wrapper { height: 20px; margin-top: 1.5rem; perspective: 1000px; }
        .status-msg { font-size: 0.9rem; text-align: center; opacity: 0; transform: rotateX(-90deg); transform-origin: top; transition: all 0.5s ease; }
        .status-msg.visible { opacity: 1; transform: rotateX(0deg); }
        .status-msg.success { color: var(--primary); text-shadow: 0 0 10px rgba(16,185,129,0.3); }
        .status-msg.error { color: #ff4d4d; }

        .loader {
            display: none; width: 24px; height: 24px; border: 3px solid rgba(255,255,255,0.3);
            border-top-color: #fff; border-radius: 50%; animation: spin 0.8s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Distortion Classes */
        body.distortion-active { filter: hue-rotate(90deg) contrast(150%); animation: timeDilation 2s cubic-bezier(0.23, 1, 0.32, 1) forwards; }
        @keyframes timeDilation { 
            0% { filter: hue-rotate(0deg) contrast(100%); } 
            30% { filter: hue-rotate(180deg) contrast(200%) blur(1px); } 
            100% { filter: hue-rotate(0deg) contrast(100%); } 
        }
        
        .reality-crack {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9;
            pointer-events: none; opacity: 0;
            background-image: linear-gradient(45deg, transparent 49%, rgba(255, 255, 255, 0.1) 50%, transparent 51%);
            background-size: 60px 60px; mix-blend-mode: overlay;
        }

        .bass-drop {
            position: fixed; top: 50%; left: 50%; width: 0; height: 0;
            border-radius: 50%; background: radial-gradient(circle, transparent 0%, var(--primary) 100%);
            z-index: 8; pointer-events: none; opacity: 0; transform: translate(-50%, -50%); mix-blend-mode: screen;
        }

        @media (max-width: 600px) { .glass-card { margin: 1rem; padding: 2rem; } h1.brand-name { font-size: 2.8rem; } }
    </style>
</head>
<body>

    <div class="bg-noise"></div>
    <div class="grid-overlay"></div>
    <div class="mouse-spotlight"></div>
    <canvas id="canvas-bg"></canvas>
    
    <div class="reality-crack" id="realityCrack"></div>
    <div class="bass-drop" id="bassDrop"></div>

    <div class="cursor-dot"></div>
    <div class="cursor-circle"></div>

    <div class="glass-card" id="tiltCard" data-tilt data-tilt-max="10" data-tilt-speed="400" data-tilt-glare data-tilt-max-glare="0.2">
        
        <div class="brand-header">
            <div class="logo-icon"><i class="fas fa-chart-pie"></i></div>
            <h1 class="brand-name" id="reactiveTitle">Savify</h1>
            <p class="subtitle">Financial Intelligence</p>
        </div>

        <form id="waitlistForm">
            <div class="input-group">
                <input type="text" id="fullName" class="input-field" placeholder=" " required autocomplete="name">
                <label class="input-label">Full Name</label>
            </div>

            <div class="input-group">
                <input type="email" id="email" class="input-field" placeholder=" " required autocomplete="email">
                <label class="input-label">Email Address</label>
            </div>

            <button type="submit" class="submit-btn hover-trigger">
                <div class="btn-content" id="btnContent">
                    <span>Get Early Access</span>
                    <i class="fas fa-arrow-right"></i>
                </div>
                <div class="loader" id="loader"></div>
            </button>
        </form>

        <div class="status-wrapper">
            <div id="statusMsg" class="status-msg"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- 1. CONFIGURATION ---
            const SUPABASE_URL = 'https://zipowqnjznngzyxdtxwm.supabase.co';
            const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InppcG93cW5qem5uZ3p5eGR0eHdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2NzEyNTQsImV4cCI6MjA4MzI0NzI1NH0.6OKydmyzpbtyWG7GzTSnXwudwBABsFVWiNfX4G7II3g';
            
            let supabase;
            try {
                if(window.supabase) {
                    supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                } else {
                    console.error("Supabase not loaded");
                }
            } catch(e) { console.error("Init Error", e); }

            // --- 2. CUSTOM CURSOR & MOUSE TRACKING ---
            const cursorDot = document.querySelector('.cursor-dot');
            const cursorCircle = document.querySelector('.cursor-circle');
            const root = document.documentElement;
            const reactiveTitle = document.getElementById('reactiveTitle');
            let mouseX = 0, mouseY = 0;
            let cursorX = 0, cursorY = 0;

            document.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
                cursorDot.style.left = mouseX + 'px';
                cursorDot.style.top = mouseY + 'px';
                
                // Update Reactive Variables
                const xPct = mouseX / window.innerWidth;
                const yPct = mouseY / window.innerHeight;
                root.style.setProperty('--mouse-x', `${xPct * 100}%`);
                root.style.setProperty('--mouse-y', `${yPct * 100}%`);
                if(reactiveTitle) reactiveTitle.style.backgroundPosition = `${xPct * 100}% center`;
            });

            function animateCursor() {
                cursorX += (mouseX - cursorX) * 0.15;
                cursorY += (mouseY - cursorY) * 0.15;
                cursorCircle.style.left = cursorX + 'px';
                cursorCircle.style.top = cursorY + 'px';
                requestAnimationFrame(animateCursor);
            }
            animateCursor();

            const interactiveEls = document.querySelectorAll('input, button, .logo-icon');
            interactiveEls.forEach(el => {
                el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
                el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
            });

            // --- 3. CANVAS BACKGROUND ---
            const canvas = document.getElementById('canvas-bg');
            const ctx = canvas.getContext('2d');
            let width, height;
            let particles = [];

            function resize() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
            }
            window.addEventListener('resize', resize);
            resize();

            class Particle {
                constructor() {
                    this.x = Math.random() * width;
                    this.y = Math.random() * height;
                    this.vx = (Math.random() - 0.5) * 0.5;
                    this.vy = (Math.random() - 0.5) * 0.5;
                    this.size = Math.random() * 2;
                    this.opacity = Math.random() * 0.5 + 0.1;
                }
                update() {
                    this.x += this.vx; this.y += this.vy;
                    if (this.x < 0) this.x = width; if (this.x > width) this.x = 0;
                    if (this.y < 0) this.y = height; if (this.y > height) this.y = 0;
                }
                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(16, 185, 129, ${this.opacity})`;
                    ctx.fill();
                }
            }

            for (let i = 0; i < 60; i++) particles.push(new Particle());

            function animateCanvas() {
                ctx.clearRect(0, 0, width, height);
                for (let i = 0; i < particles.length; i++) {
                    particles[i].update();
                    particles[i].draw();
                    const dx = mouseX - particles[i].x;
                    const dy = mouseY - particles[i].y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    if (dist < 150) {
                        ctx.beginPath();
                        ctx.strokeStyle = `rgba(16, 185, 129, ${0.2 - dist/150})`;
                        ctx.lineWidth = 1;
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(mouseX, mouseY);
                        ctx.stroke();
                    }
                }
                requestAnimationFrame(animateCanvas);
            }
            animateCanvas();

            // --- 4. ANIMATION HELPERS ---
            function playSuccessSound() {
                // Wrapped in try/catch to prevent blocking execution
                try {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    if (!AudioContext) return;
                    const ctx = new AudioContext();
                    const osc = ctx.createOscillator();
                    const gain = ctx.createGain();
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(440, ctx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(880, ctx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.1, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.5);
                    osc.connect(gain);
                    gain.connect(ctx.destination);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.5);
                } catch (e) { console.log("Audio skipped"); }
            }

            function triggerRealityEffects() {
                const bassDrop = document.getElementById('bassDrop');
                const realityCrack = document.getElementById('realityCrack');
                
                document.body.classList.add('distortion-active');
                
                // Bass Drop Visual
                bassDrop.style.width = '100vmax'; bassDrop.style.height = '100vmax'; bassDrop.style.opacity = '0.5';
                bassDrop.animate([{transform:'translate(-50%,-50%) scale(0)', opacity:0}, {transform:'translate(-50%,-50%) scale(1.5)', opacity:0}], {duration:800});
                
                // Crack Visual
                realityCrack.style.opacity = '1';
                realityCrack.animate([{transform:'scale(0.5)', opacity:0}, {transform:'scale(1.5)', opacity:0}], {duration:1500});

                setTimeout(() => document.body.classList.remove('distortion-active'), 2000);
            }

            // --- 5. FORM SUBMISSION ---
            const form = document.getElementById('waitlistForm');
            const btnContent = document.getElementById('btnContent');
            const loader = document.getElementById('loader');
            const statusMsg = document.getElementById('statusMsg');

            form.addEventListener('submit', async (e) => {
                e.preventDefault(); // STOP RELOAD
                
                // UI Loading
                btnContent.style.display = 'none';
                loader.style.display = 'block';
                statusMsg.className = 'status-msg'; 
                statusMsg.textContent = '';

                const name = document.getElementById('fullName').value.trim();
                const email = document.getElementById('email').value.trim();

                try {
                    // SUPABASE INSERT
                    const { error } = await supabase.from('waitlist').insert([{ name, email }]);
                    
                    if (error) {
                        if (error.code === '23505') throw new Error("You are already on the list!");
                        throw error;
                    }

                    // SUCCESS
                    playSuccessSound();
                    triggerRealityEffects();
                    
                    statusMsg.innerHTML = '<i class="fas fa-check-circle"></i> Access Granted. Welcome.';
                    statusMsg.classList.add('visible', 'success');
                    form.reset();

                } catch (err) {
                    console.error(err);
                    statusMsg.textContent = err.message || "Connection failed. Try again.";
                    statusMsg.classList.add('visible', 'error');
                } finally {
                    loader.style.display = 'none';
                    btnContent.style.display = 'flex';
                }
            });
        });
    </script>
</body>
</html>
